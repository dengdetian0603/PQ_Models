x = rbeta(5000, 2, 3)
y = log(x/(1-x)) - log(4/6)
plot(density(y))
qqnorm(y)
abline(a = 0, b = 1)
install.packages("spcov")
install.packages("robust")
install.packages("infotheo")
library(infotheo)
dat = data.frame(x1 = rbeta(300, 2,1), x2 = rbeta(300, 20, 10), x3 = rbeta(300, 1,1,))
interinformation(dat)
interinformation(dat, "mm")
interinformation(dat, "shrink")
interinformation(dat, "sg")
multiinformation(dat, "sg")
multiinformation(dat, "mm")
dat2 = discretize(dat)
dat2
multiinformation(dat2)
interinformation(dat2)
mutinformation(dat2$x1, dat$x2)
mutinformation(dat2$x1, dat2$x2)
dat = data.frame(x1 = rbeta(3000, 2,1), x2 = rbeta(3000, 20, 10), x3 = rbeta(3000, 1,1,))
dat = discretize(dat)
mutinformation(dat$x1, dat$x2)
dat = data.frame(x1 = rbeta(3000, 2,1), x2 = rbeta(3000, 20, 10), x3 = rbeta(3000, 2,1,))
dat = discretize(dat)
mutinformation(dat$x1, dat$x2)
mutinformation(dat$x1, dat$x3)
dat = data.frame(x1 = rbeta(3000, 2,1), x2 = rbeta(3000, 20, 10), x3 = rbeta(3000, 2,1))
dat = discretize(dat)
dat
plot(dat$x1, dat$x3)
hist(dat$x1)
dist(dat$x3)
hist(dat$x2)
hist(dat$x1)
))
hist(dat$x2)
dat = data.frame(x1 = rbeta(3000, 2,1), x2 = rbeta(3000, 20, 10), x3 = rbeta(3000, 2,1))
hist(discretize(dat$x1, "equalwidth", 30))
discretize(dat$x1, "equalwidth", 30)
hist(discretize(dat$x1, "equalwidth", 30)[,1])
hist(discretize(dat$x1, "equalfref", 30)[,1])
hist(discretize(dat$x1, "equalfreq", 30)[,1])
hist(discretize(dat$x1, "equalwidth", 30)[,1])
hist(discretize(dat$x1, "equalwidth", 60)[,1])
hist(discretize(dat$x2, "equalwidth", 60)[,1])
hist(discretize(dat$x3, "equalwidth", 60)[,1])
dat = discretize(dat, "equalwidth", 40)
mutinformation(dat$x1, dat$x3)
mutinformation(dat$x1, dat$x2)
mutinformation(dat$x3, dat$x2)
mutinformation(dat$x2, dat$x1)
mutinformation(dat$x2, dat$x3)
mutinformation(dat$x2, dat$x3)/entropy(dat$x3)
mutinformation(dat$x1, dat$x3)/entropy(dat$x3)
mutinformation(dat$x3, dat$x3)/entropy(dat$x3)
mutinformation(dat$x1, dat$x3)/entropy(dat$x3)
dat = data.frame(x1 = rbeta(3000, 4,2), x2 = rbeta(3000, 20, 10), x3 = rbeta(3000, 4,2))
dat = discretize(dat, "equalwidth", 50)
mutinformation(dat$x3, dat$x3)/entropy(dat$x3)
mutinformation(dat$x1, dat$x3)/entropy(dat$x3)
mutinformation(dat$x2, dat$x3)/entropy(dat$x3)
entropy(dat$x3)
install.packages(mpmi)
install.packages("mpmi")
library(mpmi)
install.packages("mpmi")
library(mpmi)
source("./PerchDataSimulation.R")
source("./IndepModel.R")
setwd("~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code")
setwd("~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code")
source("./PerchDataSimulation.R")
source("./IndepModel.R")
model.file = "./stan/Indep_BSandSSpos_NoReg.stan"
stan.model1 = stan_model(model.file)
par.default$ncase = 3000
par.default$nctrl = 2000
set.seed(1209)
sim.obj = do.call(SimulatePerchData, par.default)
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
par.default = SetDefaultSimulationParameter(5)
par.default$ncase = 3000
par.default$nctrl = 2000
set.seed(1209)
sim.obj = do.call(SimulatePerchData, par.default)
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
direct.fit
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
stan.result
model.file
sim.study.2 = SimStudyNoRegSTAN(
sim.obj0 = sim.obj,
sim.pars = SetDefaultSimulationParameter(5),
model.file = model.file,
par.to.save = c("mu", "bs_tpr", "ss_tpr"), method = "MAP",
n.rep = 50, seed0 = 21209)
par.to.save = c("mu", "bs_tpr", "ss_tpr")
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
model.file = "./stan/Indep_BSandSSpos_NoReg_v2.stan"
stan.model2 = stan_model(model.file)
model.file
sim.study.2 = SimStudyNoRegSTAN(
sim.obj0 = sim.obj,
sim.pars = SetDefaultSimulationParameter(5),
model.file = model.file,
par.to.save = c("mu", "bs_tpr", "ss_tpr"), method = "MAP",
n.rep = 50, seed0 = 21209)
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
par.default = SetDefaultSimulationParameter(4)
par.default$ncase = 3000
par.default$nctrl = 2000
set.seed(1209)
sim.obj = do.call(SimulatePerchData, par.default)
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
set.seed(21209)
sim.obj = do.call(SimulatePerchData, par.default)
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
set.seed(1234)
sim.obj = do.call(SimulatePerchData, par.default)
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
set.seed(999)
sim.obj = do.call(SimulatePerchData, par.default)
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
sum(c(0.05, 0.6, 0.3, 0.1, 0.045, 0.005))
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/PerchDataSimulation.R')
par.default = SetDefaultSimulationParameter(4)
par.default$ncase = 3000
par.default$nctrl = 2000
set.seed(999)
sim.obj = do.call(SimulatePerchData, par.default)
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
sim.obj$pars.baseline$Pi
sum(sim.obj$pars.baseline$Pi)
direct.fit
sim.study.2 = SimStudyNoRegSTAN(
sim.obj0 = sim.obj,
sim.pars = SetDefaultSimulationParameter(4),
model.file = model.file,
par.to.save = c("mu", "bs_tpr", "ss_tpr"), method = "MAP",
n.rep = 50, seed0 = 21209)
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
model.file = "./stan/Indep_BSandSSpos_NoReg.stan"
sim.study.2 = SimStudyNoRegSTAN(
sim.obj0 = sim.obj,
sim.pars = SetDefaultSimulationParameter(4),
model.file = model.file,
par.to.save = c("mu", "bs_tpr", "ss_tpr"), method = "MAP",
n.rep = 50, seed0 = 21209)
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
prod(1-sim.obj$pars.baseline$Mu)
sim.obj$pars.baseline$Pi
matrix(stan.result$MAP$par, ncol = 4)[,1]
prod(1-matrix(stan.result$MAP$par, ncol = 4)[,1])
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
stan.result$MAP$par
model.file
model.file = "./stan/Indep_BSandSSpos_NoReg_v2.stan"
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
hist(rbeta(500, 1, 1))
hist(rbeta(500, 2, 4))
hist(rbeta(500, 1, 2))
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
model.file
sim.study.2 = SimStudyNoRegSTAN(
sim.obj0 = sim.obj,
sim.pars = SetDefaultSimulationParameter(4),
model.file = model.file,
par.to.save = c("mu", "bs_tpr", "ss_tpr"), method = "MAP",
n.rep = 50, seed0 = 21209)
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("VB"))
stan.result$VB
sim.obj$pars.baseline$Mu
sim.study.2 = SimStudyNoRegSTAN(
sim.obj0 = sim.obj,
sim.pars = SetDefaultSimulationParameter(4),
model.file = model.file,
par.to.save = c("mu", "bs_tpr", "ss_tpr"), method = "MAP",
n.rep = 150, seed0 = 21209)
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
model.file = "./stan/Indep_LogitPrior_BSandSSpos_NoReg_v2.stan"
stan.model3 = stan_model(model.file)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par, ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
stan.result$MAP$par
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
hist(Logit(rnorm(500, -0.9, sqrt(0.6))))
hist(InvLogit(rnorm(500, -0.9, sqrt(0.6))))
hist(InvLogit(rnorm(500, -0.4, sqrt(0.6))))
hist(InvLogit(rnorm(500, -0.4, sqrt(0.9))))
hist(InvLogit(rnorm(500, -0.4, sqrt(1))))
hist(InvLogit(rnorm(500, -0.5, sqrt(1))))
hist(InvLogit(rnorm(500, -0.5, sqrt(1))), breaks = 25)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
hist(InvLogit(rnorm(1000, -0.5, 0.8)))
hist(InvLogit(rnorm(1000, -0.5, 0.8)), breaks=20)
hist(InvLogit(rnorm(1000, -0.5, 1.8)), breaks=20)
hist(InvLogit(rnorm(1000, -0.5, 2.8)), breaks=20)
hist(InvLogit(rnorm(1000, -0.5, 1.3)), breaks=20)
hist(InvLogit(rnorm(1000, -0.5, 1.2)), breaks=20)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
par.default$ncase = 1500
par.default$nctrl = 1000
set.seed(999)
sim.obj = do.call(SimulatePerchData, par.default)
sim.obj$pars.baseline$Pi
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
par.default$ncase = 5000
par.default$nctrl = 2000
set.seed(999)
sim.obj = do.call(SimulatePerchData, par.default)
sim.obj$pars.baseline$Pi
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
sim.study.2 = SimStudyNoRegSTAN(
sim.obj0 = sim.obj,
sim.pars = SetDefaultSimulationParameter(4),
model.file = model.file,
par.to.save = c("mu", "bs_tpr", "ss_tpr"), method = "MAP",
n.rep = 150, seed0 = 21209)
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
sim.study.2 = SimStudyNoRegSTAN(
sim.obj0 = sim.obj,
sim.pars = SetDefaultSimulationParameter(4),
model.file = model.file,
par.to.save = c("mu", "bs_tpr", "ss_tpr"), method = "MAP",
n.rep = 150, seed0 = 21209)
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
SetDefaultSimulationParameter(4)
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/PerchDataSimulation.R')
source('~/Documents/JHSPH/Research/S.Zeger/PQ_Models/Code/IndepModel.R')
SetDefaultSimulationParameter(4)
sim.study.2 = SimStudyNoRegSTAN(
sim.obj0 = sim.obj,
sim.pars = SetDefaultSimulationParameter(4),
model.file = model.file,
par.to.save = c("mu", "bs_tpr", "ss_tpr"), method = "MAP",
n.rep = 150, seed0 = 21209)
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
set.seed(1999)
sim.obj = do.call(SimulatePerchData, par.default)
sim.obj$pars.baseline$Pi
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
set.seed(9999)
sim.obj = do.call(SimulatePerchData, par.default)
sim.obj$pars.baseline$Pi
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
set.seed(9991)
sim.obj = do.call(SimulatePerchData, par.default)
sim.obj$pars.baseline$Pi
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
set.seed(2999)
sim.obj = do.call(SimulatePerchData, par.default)
sim.obj$pars.baseline$Pi
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
set.seed(7999)
sim.obj = do.call(SimulatePerchData, par.default)
sim.obj$pars.baseline$Pi
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
set.seed(1999)
sim.obj = do.call(SimulatePerchData, par.default)
sim.obj$pars.baseline$Pi
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
set.seed(6999)
sim.obj = do.call(SimulatePerchData, par.default)
sim.obj$pars.baseline$Pi
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
set.seed(999)
sim.obj = do.call(SimulatePerchData, par.default)
sim.obj$pars.baseline$Pi
direct.fit = FitMLEgivenGSNoReg(par.default$K, sim.obj)
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("MAP"))
matrix(stan.result$MAP$par[-(1:5)], ncol = 4)
round(cbind(sim.obj$pars.baseline$Mu,
par.default$ss.tpr,
par.default$bs.tpr,
par.default$bs.fpr), 3)
FitStanNoReg(sim.obj, "mu", model.file, method = c("VB"))
sim.obj$pars.baseline$Mu
stan.result = FitStanNoReg(sim.obj, "mu", model.file, method = c("HMC"))
stan.result$HMC
sim.obj$pars.baseline$Mu
plot(sim.obj$pars.baseline$Mu)
plot(stan.result$HMC)
traceplot(stan.result$HMC)
save(stan.result, file = "k5_noreg_hmc.rdata")
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
sim.study.2 = SimStudyNoRegSTAN(
sim.obj0 = sim.obj,
sim.pars = SetDefaultSimulationParameter(4),
model.file = model.file,
par.to.save = c("mu", "bs_tpr", "ss_tpr"), method = "VB",
n.rep = 50, seed0 = 21209)
true.par = TrueParVal(sim.study.2, par.to.save)
PlotSimStudy(sim.study.2$stan.fit.all, true.par)
